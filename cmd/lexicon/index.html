<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE SOVEREIGN LEDGER // PHALANX</title>

    <!-- PURE V3 STACK: TAILWIND CDN ONLY -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 'term-black': '#050505', 'term-green': '#00ff33' },
                    fontFamily: { mono: ['Courier New', 'monospace'] }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #050505;
            color: #00ff33;
            cursor: crosshair;
            display: none;
        }

        .glass-panel {
            background: rgba(10, 20, 10, 0.9);
            border: 1px solid #00ff33;
            box-shadow: 0 0 15px rgba(0, 255, 51, 0.1);
            transition: all 0.3s ease;
        }

        .input-heavy {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(0, 255, 51, 0.5);
            color: white;
            padding: 1rem;
            width: 100%;
            font-size: 1.25rem;
            text-transform: uppercase;
            outline: none;
            transition: all 0.2s ease;
        }

        .input-heavy:focus {
            border-color: #00ff33;
            box-shadow: 0 0 15px rgba(0, 255, 51, 0.4);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #111;
        }

        ::-webkit-scrollbar-thumb {
            background: #00ff33;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #fff;
        }
    </style>

    <!-- MSX SIDEBAR INJECTION -->
    <script type="module" src="../../assets/js/sidebar.js"></script>
</head>

<body
    class="pl-0 lg:pl-[256px] h-screen h-[100dvh] w-full font-mono selection:bg-[#00ff33] selection:text-black flex flex-col items-center overflow-hidden bg-black">

    <!-- PURE V3 MINIMAL NAV -->
    <nav
        class="w-full border-b border-[#00ff33]/30 p-4 mb-8 flex justify-between items-center bg-black/80 sticky top-0 z-50">
        <a href="../../"
            class="text-sm font-bold text-[#00ff33] hover:text-white transition-colors tracking-[0.2em] border border-[#00ff33]/50 px-4 py-2 hover:bg-[#00ff33]/20">
            [ RETURN TO MATRIX ]
        </a>
        <div class="text-[10px] text-[#00ff33]/60 tracking-widest uppercase flex items-center gap-4">
            <span class="animate-pulse">DATABASE: ONLINE</span>
        </div>
    </nav>

    <div id="main-container"
        class="flex-1 w-full max-w-7xl px-4 md:px-8 flex flex-col md:flex-row gap-8 opacity-0 transition-opacity duration-500 overflow-hidden relative pb-4 md:pb-8">

        <!-- SIDEBAR: INDEX SEARCH -->
        <div id="sidebar" class="glass-panel w-full md:w-80 flex md:flex flex-col h-full shrink-0 z-30 relative">
            <div class="p-6 border-b border-[#00ff33]/30">
                <h1
                    class="text-2xl font-bold tracking-[0.1em] text-[#00ff33] uppercase drop-shadow-[0_0_8px_rgba(0,255,51,0.5)]">
                    THE LEDGER</h1>
                <div class="text-[10px] tracking-widest mt-2 uppercase text-white/50">> TERMINOLOGY INDEX</div>

                <input type="text" id="search-input" class="input-heavy text-sm p-3 mt-4" placeholder="QUERY_DB..."
                    autocomplete="off">
            </div>

            <div id="index-list" class="flex-1 overflow-y-auto p-2 space-y-1">
                <!-- Javascript Injection -->
            </div>
        </div>

        <!-- MAIN TERMINAL: DEFINITION -->
        <div id="reader" class="glass-panel flex-1 hidden md:flex flex-col h-full overflow-hidden relative z-20">
            <!-- MOBILE RETURN BTN -->
            <div class="md:hidden p-3 border-b border-[#00ff33]/30 bg-black/80 shrink-0">
                <button onclick="toggleView('sidebar')"
                    class="flex items-center gap-2 text-[#00ff33] hover:text-white text-[10px] font-bold uppercase tracking-widest transition-colors">
                    &lt; RETURN TO INDEX
                </button>
            </div>

            <div id="content-display" class="p-8 md:p-12 overflow-y-auto h-full relative custom-scrollbar">
                <div class="text-center text-[#00ff33]/50 tracking-[0.2em] mt-32 animate-pulse">
                    AWAITING OPERATOR QUERY...
                </div>
            </div>
        </div>

    </div>

    <!-- PURE V3 LOGIC -->
    <script>
        const DB = {
            'THE_RUST': { title: 'THE RUST', type: 'ENTITY', img: '../../assets/images/lexicon/Graphic_The_Rust_Tower_Banks_Media_Goon_Squad.png', def: 'A parasitic, non-sentient system of elite control. It functions through a symbiotic fusion with State Power (The Crown) to enforce Managed Decline. Its only purpose is to corrode structure, extract value from the "Gears", and weaken the productive host to fuel its own infinite, cancerous growth.', links: [{ text: 'JPMORGAN: UNINDICTED', url: 'https://constructamiracle.com/p/jpmorgan-chase-the-unindicted-co' }] },
            'THE_GEARS': { title: 'THE GEARS', type: 'ENTITY', img: '../../assets/images/lexicon/Graphic_Social_Gears_Collage_Tan.png', def: 'The productive majority (Labor, Creators, Builders) who generate 100% of civilization\'s value. To the Rust, they are merely "Fuel" for the machine. The outcome of the Vertical War depends entirely on whether they remain isolated victims or recognize their collective leverage to become the "Phalanx".' },
            'VERTICAL_WAR': { title: 'VERTICAL WAR', type: 'DOCTRINE', img: '../../assets/images/lexicon/Vertical%20War.webp', links: [{ text: 'THE ILLUSION INDEX', url: 'https://constructamiracle.com/p/the-illusion-index' }], def: 'The true conflict of the 21st century. It is the silent, economic siege between the Productive Class (Down) and the Parasitic Class (Up). While the Horizontal War (Left vs Right) distracts the population with endless culture battles, the Vertical War is the undeniable economic reality where assets are stripped from the many and transferred to the few.' },
            'HORIZONTAL_WAR': { title: 'HORIZONTAL WAR', type: 'SIMULATION', img: '../../assets/images/lexicon/horizontal%20war.jpg', def: 'The distracting theater of partisan politics (Red vs. Blue). A simulation designed to keep the Gears looking sideways at each other instead of up at the Rust. It operates in the "Puppet Colosseum".' },
            'PHALANX': { title: 'PHALANX', type: 'STRATEGY', img: '../../assets/images/lexicon/Graphic_Flaming_Blue_Neon_Anarchy_Gear.png', def: 'The organized resistance mechanism. Not just a militia, but an economic immune system. A reader-supported fortress that funds the War Council, allowing the rebellion to bypass corporate patronage.' },
            'HARDWARE': { title: 'HARDWARE', type: 'REALITY', img: '../../assets/images/lexicon/hardware.gif', def: 'Fixed, verifiable reality: bill text, bank ledgers, biological pain, grocery receipts. The Road. The only ground we can stand on.' },
            'SOFTWARE': { title: 'SOFTWARE', type: 'NARRATIVE', img: '../../assets/images/lexicon/Graphic_System_Processing_99_Percent_Glitch_Bar.png', def: 'Malleable narratives: expert consensus, headlines, political rhetoric. The Windshield.' },
            'THE_WINDSHIELD': { title: 'THE WINDSHIELD', type: 'TACTIC', img: '../../assets/images/lexicon/windshield.gif', def: 'The filtered reality presented by media and academia. It blocks the raw data (The Road) and replaces it with a safe story.' },
            'CREDIT': { title: 'CREDIT', type: 'TRANSLATION', img: '../../assets/images/lexicon/WoIEP6.webp', link: 'https://constructamiracle.com/p/the-financial-siege-the-war-on-illusion', def: 'Sovereign Translation: <strong>Obedience Score.</strong> A measure of how well you service the Rust. A "Good Credit Score" simply means you are a profitable host organism&rdquo;you borrow, you pay interest, and you stay in the cage.' },
            'LIQUIDITY': { title: 'LIQUIDITY', type: 'TRANSLATION', def: 'Sovereign Translation: Looting. The extraction of value from real-world resources and labor into frictionless capital that can flee the moment a community is drained.' },
            'INTEREST': { title: 'INTEREST', type: 'TRANSLATION', def: 'Sovereign Translation: Exponential Extraction. The mechanism by which wealth exponentially abandons the worker to compound for the owner.' },
            'ENGAGEMENT': { title: 'ENGAGEMENT', type: 'METRIC', img: '../../assets/images/lexicon/engagement.jpg', def: 'Military term for "hostile contact". A cold metric of captivity measuring how long a mind can be held in a loop before breaking.' },
            'THE_FEED': { title: 'THE FEED', type: 'CONTROL', img: '../../assets/images/lexicon/Feed.webp', def: 'Military term for "cannon fodder". A system designed to position the user as livestock. It does not deliver information; it manages a state of perpetual, low-grade craving.' },
            'CONSTRUCTED_MIRACLE': { title: 'CONSTRUCTED MIRACLE', type: 'STRATEGY', img: '../../assets/images/lexicon/Sketch_Construct_Miracle_Floral_Wreath.jpg', def: 'The Doctrine of Anti-Fatalism. We reject "fate", "luck", or "hope" as strategies. A miracle is not something we pray for; it is something we engineer.' },
            'THE_USER': { title: 'THE_USER', type: 'TRANSLATION', img: '../../assets/images/lexicon/follower.webp', def: 'Clinical term for "addict". A deliberate inversion where the resource being strip-mined (attention) is flattered into believing it is the operator.' },
            'THREE_LAYERED_PRISON': { title: 'THREE-LAYERED PRISON', type: 'SYSTEM', img: '../../assets/images/lexicon/3layerprison.png', def: 'The total architecture of control designed to keep the Gears trapped in the machine. Layer 1: Economic Terror. Layer 2: The Great Distraction. Layer 3: Learned Helplessness.' },
            'SOMATIC_SKEPTICISM': { title: 'SOMATIC SKEPTICISM', type: 'SKILL', def: 'Trusting the biological alert (gut/hardware) over the screen (noise). The body knows the lie before the brain does.' },
            'TRUTH_BULLET': { title: 'TRUTH BULLET', type: 'WEAPON', img: '../../assets/images/lexicon/Graphic_The_Flint_Indictment_Truth_Bullet_GM.png', def: 'A single, potent, verifiable fact, piece of data, or quote. A precision-guided projectile fired at a specific contradiction or lie in the enemy\'s narrative to cause a catastrophic logical failure.' }
        };

        // JavaScript Mobile Toggle Logic
        window.toggleView = function (v) {
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                const reader = document.getElementById('reader');

                if (v === 'reader') {
                    sidebar.classList.remove('flex'); sidebar.classList.add('hidden');
                    reader.classList.remove('hidden'); reader.classList.add('flex');
                } else {
                    sidebar.classList.remove('hidden'); sidebar.classList.add('flex');
                    reader.classList.remove('flex'); reader.classList.add('hidden');
                }
            }
        };

        const UI = {
            body: document.body,
            container: document.getElementById('main-container'),
            list: document.getElementById('index-list'),
            display: document.getElementById('content-display'),
            search: document.getElementById('search-input')
        };

        // Anti-Flicker
        setTimeout(() => {
            UI.body.style.display = 'flex';
            setTimeout(() => UI.container.classList.remove('opacity-0'), 50);
        }, 100);

        function initIndex() {
            renderList(Object.keys(DB).sort());
        }

        function renderList(keys) {
            UI.list.innerHTML = keys.map((key, i) => `
                <button id="btn-${key}" onclick="loadTerm('${key}')" class="w-full text-left px-4 py-3 text-xs font-bold font-mono text-white/50 hover:text-[#00ff33] hover:bg-[#00ff33]/10 transition-colors border-l-4 border-transparent hover:border-[#00ff33] uppercase">
                    ${(i + 1).toString().padStart(2, '0')}. ${DB[key].title}
                </button>
            `).join('');
        }

        window.loadTerm = (key) => {
            const data = DB[key];
            if (!data) return;

            // Update URL Hash
            history.pushState(null, null, `#${key}`);

            // Active Stylings
            document.querySelectorAll('#index-list button').forEach(b => {
                b.classList.remove('text-[#00ff33]', 'bg-[#00ff33]/20', 'border-[#00ff33]');
                b.classList.add('text-white/50', 'border-transparent');
            });
            const btn = document.getElementById(`btn-${key}`);
            if (btn) btn.classList.add('text-[#00ff33]', 'bg-[#00ff33]/20', 'border-[#00ff33]');

            if (window.innerWidth <= 768) toggleView('reader');

            // Render
            let imgHTML = data.img ? `<div class="mb-8 border border-[#00ff33]/30 shadow-[0_0_20px_rgba(0,255,51,0.1)] bg-black/50 p-2"><img src="${data.img}" class="w-full max-h-64 object-cover opacity-80" alt="${data.title}"></div>` : '';

            let linkHTML = '';
            if (data.links && data.links.length > 0) {
                linkHTML = `<div class="mt-8 pt-6 border-t border-[#00ff33]/20 flex flex-wrap gap-4">` +
                    data.links.map(l => `<a href="${l.url}" target="_blank" class="border border-[#00ff33]/50 text-[#00ff33] px-4 py-2 text-xs font-bold hover:bg-[#00ff33]/20 transition-colors">[ ${l.text} ]</a>`).join('') +
                    `</div>`;
            } else if (data.link) {
                linkHTML = `<div class="mt-8 pt-6 border-t border-[#00ff33]/20"><a href="${data.link}" target="_blank" class="border border-[#00ff33]/50 text-[#00ff33] px-4 py-2 text-xs font-bold hover:bg-[#00ff33]/20 transition-colors">[ EXTERNAL DOCUMENT ]</a></div>`;
            }

            // Cross-linking logic
            let linkedDef = data.def;
            Object.keys(DB).forEach(iterKey => {
                if (iterKey !== key) {
                    const regex = new RegExp(`\\b${DB[iterKey].title}\\b`, 'gi');
                    linkedDef = linkedDef.replace(regex, `<span class="text-[#00ff33] cursor-pointer hover:underline font-bold" onclick="loadTerm('${iterKey}')">$&</span>`);
                }
            });

            UI.display.innerHTML = `
                <div class="animate-pulse mb-2 text-[10px] tracking-widest text-[#00ff33]/50">[ DECRYPTING_RECORD_ID: ${key} ]</div>
                <div class="flex items-center gap-4 mb-6">
                    <h2 class="text-4xl md:text-5xl font-bold tracking-[0.1em] text-white">${data.title}</h2>
                    <span class="px-2 py-1 bg-[#00ff33]/20 text-[#00ff33] text-xs font-bold tracking-widest">${data.type}</span>
                </div>
                ${imgHTML}
                <p class="text-lg leading-relaxed text-white/80 border-l-2 border-[#00ff33]/50 pl-6 mt-6">
                    ${linkedDef}
                </p>
                ${linkHTML}
            `;
        };

        // Search Filter
        UI.search.onkeyup = (e) => {
            const query = e.target.value.toUpperCase();
            const keys = Object.keys(DB).filter(k => DB[k].title.includes(query) || DB[k].type.includes(query));
            renderList(keys);
        };

        // Hash Navigation Map
        window.onhashchange = () => {
            const hash = window.location.hash.replace('#', '');
            if (hash && DB[hash]) loadTerm(hash);
        };

        // Boot
        initIndex();
        if (window.location.hash) {
            const initialTarget = window.location.hash.replace('#', '');
            if (DB[initialTarget]) loadTerm(initialTarget);
        }
    </script>
</body>

</html>